<&| /Admin/Queues/Elements/SortableBox, prefix => $prefix, is_filter => 1, class_name => 'ExcludedDates' &>
<p>This filter selects eligible owners by datetime custom fields on users, meant for scheduled vacations. If the current date and time falls between the following two custom fields, the user will be excluded from automatic assignment.</p>

% if ($user_cfs->Count) {
<table>
<tr>
<td class="label"><label for="<% $prefix %>_begin">Begin Custom Field:</label></td>
<td class="value">
<select id="<% $prefix %>_begin" name="<% $prefix %>_begin">
<option value="">-</option>
% while (my $cf = $user_cfs->Next) {
<option <% ($config->{begin}||0) == $cf->Id ? "selected" : "" %> value="<% $cf->Id %>"><% $cf->Name %></option>
% }
</select>
</td>
</tr>
<tr>
<td class="label"><label for="<% $prefix %>_end">End Custom Field:</label></td>
<td class="value">
<select id="<% $prefix %>_end" name="<% $prefix %>_end">
<option value="">-</option>
% while (my $cf = $user_cfs->Next) {
<option <% ($config->{end}||0) == $cf->Id ? "selected" : "" %> value="<% $cf->Id %>"><% $cf->Name %></option>
% }
</select>
</td>
</tr>
</table>
% } else {
<p>No user custom fields found.</p>
% }
</&>
<%INIT>
my $user_cfs = RT::CustomFields->new($session{CurrentUser});
$user_cfs->LimitToLookupType(RT::User->CustomFieldLookupType);
$user_cfs->ApplySortOrder;
</%INIT>
<%ARGS>
$prefix
$config
$queue
</%ARGS>
